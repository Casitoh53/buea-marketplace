<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>BUMACE - Customer Dashboard</title>
  <style>
    :root{
      --blue:#3498db;
      --dark:#2c3e50;
      --muted:#f4f7fb;
      --card-bg:#ffffff;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:Inter, "Segoe UI", Roboto, Arial, sans-serif;
      background:var(--muted);
      display:flex;
      min-height:100vh;
      color:#222;
    }

    /* Sidebar */
    .sidebar{
      width:230px;
      background:var(--dark);
      color:#fff;
      padding:22px;
      display:flex;
      flex-direction:column;
      gap:8px;
    }
    .sidebar h2{ text-align:center; margin:0 0 6px; color:var(--blue); }
    .sidebar a{
      color:#fff; text-decoration:none; padding:10px 12px; border-radius:8px;
      display:flex; align-items:center; gap:10px; cursor:pointer;
    }
    .sidebar a:hover{ background:#34495e; }

    /* Main content */
    .main{flex:1; padding:28px;}
    .content-section{
      background:var(--card-bg); padding:22px; border-radius:12px;
      box-shadow:0 6px 18px rgba(15,23,42,0.06); margin-bottom:20px;
    }

    .welcome{
      background:linear-gradient(135deg,var(--blue),#9b59b6);
      color:#fff; padding:22px; border-radius:10px; margin-bottom:16px;
    }
    .welcome h2{margin:0 0 6px; font-size:20px;}

    /* Cards grid */
    .cards{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
      gap:18px;
    }
    .card{
      background:var(--card-bg); padding:18px; border-radius:10px; min-height:110px;
      box-shadow:0 2px 8px rgba(15,23,42,0.04);
    }
    .card h3{margin:0 0 8px; color:var(--blue); font-size:16px;}

    .card p{margin:6px 0; color:#444; font-size:14px;}
    .card .small{font-size:13px;color:#666}

    .btn{
      background:var(--blue); color:#fff; border:none; padding:10px 12px;
      border-radius:8px; cursor:pointer; font-size:14px;
    }
    .btn.secondary{ background:#6c757d; }
    .btn.danger{ background:#e74c3c; }

    /* Profile */
    .profile-card{ display:flex; gap:28px; align-items:flex-start; flex-wrap:wrap; }
    .profile-avatar{ flex:0 0 150px; text-align:center; }
    .profile-avatar img{
      width:130px;height:130px;border-radius:50%;object-fit:cover;border:4px solid var(--blue);
    }
    .profile-avatar input[type=file]{ margin-top:12px; font-size:13px; }

    .profile-details{ flex:1; min-width:260px; }
    .profile-details label{ display:block; font-weight:600; margin:10px 0 6px; font-size:13px; }
    .profile-details input, .profile-details textarea{
      width:100%; padding:10px; border-radius:8px; border:1px solid #dcdcdc; font-size:14px;
    }
    .profile-actions{ display:flex; gap:10px; margin-top:12px; flex-wrap:wrap; }

    /* Account info small avatar */
    .account-info {
      display:flex; align-items:center; gap:12px;
    }
    .account-info img{ width:48px; height:48px; border-radius:50%; object-fit:cover; border:2px solid #eee; }

    @media(max-width:820px){
      .sidebar{ display:none; }
      body{ flex-direction:column; }
      .main{ padding:18px; }
    }
  </style>
</head>
<body>
  <div class="sidebar">
    <h2>BUMACE</h2>
    <a onclick="showSection('dashboard')">üè† Dashboard</a>
    <a onclick="showSection('profile')">üôç Profile</a>
    <a onclick="showSection('orders')">üßæ Orders</a>
    <a href="cart.html">üõí My Cart</a>
    <a href="checkout.html">üí≥ Checkout</a>
    <a href="home.html">üîì Logout</a>
  </div>

  <div class="main" id="main-content">
    <!-- DASHBOARD SECTION -->
    <div id="dashboard-section" class="content-section">
      <div class="welcome">
        <h2 id="welcomeName">Welcome, Customer üëã</h2>
        <p id="welcomeText">Here‚Äôs a quick overview of your account.</p>
      </div>

      <!-- Cards (this was missing previously) -->
      <div class="cards">
        <div class="card">
          <h3>Recent Orders</h3>
          <p id="orders-count">You have 0 pending orders.</p>
          <p class="small">Orders are stored locally for demo. In production, fetch from your DB.</p>
          <div style="margin-top:12px">
            <button class="btn" onclick="showSection('orders')">View Orders</button>
          </div>
        </div>

        <div class="card">
          <h3>Account Info</h3>
          <div class="account-info" style="margin-bottom:10px;">
            <img id="accountAvatar" src="https://img.icons8.com/fluency/48/user-male-circle.png" alt="avatar">
            <div>
              <div id="accountName" style="font-weight:700">John Doe</div>
              <div id="accountEmail" class="small">customer@example.com</div>
            </div>
          </div>

          <p id="accountPhone" class="small">Phone: +237 678 000 111</p>
          <div style="margin-top:12px">
            <button class="btn" onclick="showSection('profile')">Edit Profile</button>
          </div>
        </div>

        <div class="card">
          <h3>Quick Access</h3>
          <p class="small">Shortcuts to common actions.</p>
          <div style="margin-top:12px; display:flex; gap:8px; flex-wrap:wrap;">
            <button class="btn" onclick="window.location.href='shop.html'">Shop Now</button>
            <button class="btn secondary" onclick="window.location.href='cart.html'">View Cart</button>
          </div>
        </div>
      </div>
    </div>

    <!-- PROFILE SECTION -->
    <div id="profile-section" class="content-section" style="display:none;">
      <h2>My Profile</h2>
      <div class="profile-card">
        <div class="profile-avatar">
          <img id="profileImage" src="https://img.icons8.com/fluency/240/user-male-circle.png" alt="User">
          <input id="imageUpload" type="file" accept="image/*" />
        </div>

        <div class="profile-details">
          <form id="profileForm">
            <label for="name">Full Name</label>
            <input id="name" type="text" value="John Doe" />

            <label for="email">Email</label>
            <input id="email" type="email" value="customer@example.com" />

            <label for="phone">Phone</label>
            <input id="phone" type="tel" value="+237 678 000 111" />

            <label for="address">Address</label>
            <textarea id="address" rows="3">123 Buea, Cameroon</textarea>

            <div class="profile-actions">
              <button class="btn" type="submit">Save Profile</button>
              <button class="btn" type="button" id="changePasswordBtn">Change Password</button>
              <button class="btn danger" type="button" onclick="deleteAccount()">Delete Account</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- ORDERS SECTION -->
    <div id="orders-section" class="content-section" style="display:none;">
      <h2>My Orders</h2>
      <div id="ordersList">
        <p class="small">No orders available yet.</p>
      </div>
    </div>
  </div>

  <script>
    /* -------- Section switcher -------- */
    function showSection(section){
      document.getElementById('dashboard-section').style.display='none';
      document.getElementById('profile-section').style.display='none';
      document.getElementById('orders-section').style.display='none';

      if(section==='dashboard') document.getElementById('dashboard-section').style.display='block';
      if(section==='profile') document.getElementById('profile-section').style.display='block';
      if(section==='orders') document.getElementById('orders-section').style.display='block';
    }

    /* -------- Load profile & UI data -------- */
    function loadProfileIntoUI(){
      const saved = JSON.parse(localStorage.getItem('profileData') || 'null');
      const orders = JSON.parse(localStorage.getItem('orders') || '[]');

      // Defaults
      const defaultProfile = {
        name:'John Doe', email:'customer@example.com', phone:'+237 678 000 111',
        address:'123 Buea, Cameroon', image:null
      };
      const profile = saved || defaultProfile;

      // Profile form fields
      document.getElementById('name').value = profile.name || '';
      document.getElementById('email').value = profile.email || '';
      document.getElementById('phone').value = profile.phone || '';
      document.getElementById('address').value = profile.address || '';

      // Images
      const avatar = profile.image || 'https://img.icons8.com/fluency/48/user-male-circle.png';
      document.getElementById('profileImage').src = profile.image || 'https://img.icons8.com/fluency/240/user-male-circle.png';
      document.getElementById('accountAvatar').src = avatar;

      // Dashboard texts
      document.getElementById('welcomeName').innerText = `Welcome, ${profile.name || 'Customer'} üëã`;
      document.getElementById('accountName').innerText = profile.name || '';
      document.getElementById('accountEmail').innerText = profile.email || '';
      document.getElementById('accountPhone').innerText = `Phone: ${profile.phone || ''}`;

      // Orders
      document.getElementById('orders-count').innerText = `You have ${orders.length} pending order${orders.length !== 1 ? 's' : ''}.`;
      renderOrdersList(orders);
    }

    function renderOrdersList(orders){
      const container = document.getElementById('ordersList');
      container.innerHTML = '';
      if(!orders || orders.length === 0){
        container.innerHTML = `<p class="small">No orders available yet.</p>`;
        return;
      }
      orders.forEach((o, i) => {
        const el = document.createElement('div');
        el.style.padding='10px';
        el.style.borderBottom='1px solid #eee';
        el.innerHTML = `<strong>Order #${i+1}</strong> ‚Ä¢ ${o.status || 'Pending'} <div class="small">Total: ${o.total || 0} CFA</div>`;
        container.appendChild(el);
      });
    }

    /* -------- Save profile from form -------- */
    document.getElementById('profileForm').addEventListener('submit', function(e){
      e.preventDefault();
      // Build object (keep existing image if any)
      const current = JSON.parse(localStorage.getItem('profileData') || 'null') || {};
      const profileData = {
        name: document.getElementById('name').value.trim() || current.name || 'Customer',
        email: document.getElementById('email').value.trim() || current.email || '',
        phone: document.getElementById('phone').value.trim() || current.phone || '',
        address: document.getElementById('address').value.trim() || current.address || '',
        image: document.getElementById('profileImage').src || current.image || null
      };
      localStorage.setItem('profileData', JSON.stringify(profileData));
      alert('Profile saved successfully.');
      loadProfileIntoUI();
      showSection('dashboard');
    });

    /* -------- Image upload (save immediately) -------- */
    document.getElementById('imageUpload').addEventListener('change', function(e){
      const file = this.files && this.files[0];
      if(!file) return;
      const reader = new FileReader();
      reader.onload = function(evt){
        const dataUrl = evt.target.result;
        document.getElementById('profileImage').src = dataUrl;
        document.getElementById('accountAvatar').src = dataUrl;

        // Save/merge into stored profile
        const current = JSON.parse(localStorage.getItem('profileData') || 'null') || {};
        const newProfile = {
          name: current.name || document.getElementById('name').value || 'Customer',
          email: current.email || document.getElementById('email').value || '',
          phone: current.phone || document.getElementById('phone').value || '',
          address: current.address || document.getElementById('address').value || '',
          image: dataUrl
        };
        localStorage.setItem('profileData', JSON.stringify(newProfile));
      };
      reader.readAsDataURL(file);
    });

    /* -------- Change password (demo prompt) -------- */
    document.getElementById('changePasswordBtn').addEventListener('click', function(){
      const currentStored = localStorage.getItem('userPassword') || '';
      if(currentStored){
        const old = prompt('Enter current password:');
        if(old !== currentStored){ alert('Incorrect current password.'); return; }
      }
      const pw = prompt('Enter new password:');
      if(!pw){ alert('Password not changed.'); return; }
      const pw2 = prompt('Confirm new password:');
      if(pw !== pw2){ alert('Passwords do not match.'); return; }
      localStorage.setItem('userPassword', pw);
      alert('Password changed (demo).');
    });

    /* -------- Delete account -------- */
    function deleteAccount(){
      if(!confirm('Are you sure you want to delete your account? This will remove your local data.')) return;
      localStorage.clear();
      alert('Account deleted.');
      window.location.href = 'index.html';
    }

    /* -------- Logout -------- */
    function logout(){
      localStorage.clear();
      window.location.href = 'index.html';
    }

    /* -------- Initialize on load -------- */
    window.addEventListener('load', function(){
      loadProfileIntoUI();
      showSection('dashboard');
    });
    const orders = JSON.parse(localStorage.getItem('orders') || '[]');
document.getElementById('orders-count').innerText = `You have ${orders.length} pending order${orders.length !== 1 ? 's' : ''}.`;
renderOrdersList(orders);

  </script>
</body>
</html>
